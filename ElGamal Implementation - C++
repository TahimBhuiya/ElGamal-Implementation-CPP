// Tahim Bhuiya
// ElGamal Implementation in C++ 
#include <iostream>
#include <vector>
#include <cmath>
#include <ctime>
#include <cstdlib>
#include <string>
#include <tuple>
using namespace std;

// Greatest Common Divisor
int gcd(int a, int b) {
    return b == 0 ? a : gcd(b, a % b);
}

// Modular Exponentiation (Square-and-Multiply)
int power(int a, int b, int c) {
    int result = 1;
    a = a % c;
    while (b > 0) {
        if (b % 2 == 1)
            result = (result * a) % c;
        a = (a * a) % c;
        b /= 2;
    }
    return result;
}

// Fermat Primality Test
bool is_prime(int p) {
    if (p < 2 || p % 2 == 0) return false;
    return power(2, p - 1, p) == 1;
}